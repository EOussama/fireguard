<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  >
  <title>Fireguard Test</title>
</head>

<body>
  <h1>Fireguard Test</h1>
  <p>This page serves as a trigger for Fireguard, for testing purposes.</p>
  <button onclick="trigger()">Open Fireguard</button>

  <script>
    function trigger() {
      const width = 450;
      const height = 260;
      const top = 50;
      const left = window.screen.width / 2 - width / 2;

      const conf = `width=${width},height=${height},left=${left},top=${top}`;
      const win = window.open('http://localhost:5173', '_blank', conf);

      window.addEventListener('message', e => {
        if (e.isTrusted) {
          switch (e.data.type) {
            case 0: {
              if (e.data.payload.loaded) {
                const data = { type: 1, payload: { appName: 'Clave', authMethod: 3 } };
                win.postMessage(data, '*');
              }

              break;
            }

            case 2: {
              console.log('Auth succeeded');
              break;
            }

            case 3: {
              console.log('Auth failed');
              break;
            }
          }
        }
      });
    }
  </script>
</body>

</html>